#!/bin/bash
set -o nounset -o errexit -o pipefail

# Check if a subcommand is specified, otherwise default to build
if [[ $# -ge 1 ]]; then
    COMMAND=$1
else
    COMMAND=build
fi

# If we have a cabal file
if [[ "$(ls -1 | grep '\.cabal$')" != "" ]]; then
    exec cabal $COMMAND
elif [[ "$(ls -1 | grep -i '^makefile$')" != "" ]]; then
    exec make
else
    echo "No cabal file nor makefile found"
    exit 1
fi
